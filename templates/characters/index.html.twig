{% extends 'base.html.twig' %}

{% block title %}Hello CharacterController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Select a Dimension</h1>
    <select id="dimensionDropdown">
        <option value="">-- Select a Dimension --</option>
        {% for dimension in dimensions %}
            <option value="{{ dimension['id'] }}">{{ dimension['name'] }}</option>
        {% endfor %}
    </select>
</div>

<div id="charactersList">
    <!-- Characters will be rendered here -->
</div>

<script>
    document.getElementById('dimensionDropdown').addEventListener('change', function() {
        var dimension = this.value;
        if(dimension) {
            fetch('/dimension/' + dimension + '/characters')
                .then(response => response.json())
                .then(data => {
                    // For demonstration, display the location info and a list of resident names.
                    var html = '<h2>' + data.name + ' (' + data.dimension + ')</h2>';
                    html += '<p>Type: ' + data.type + '</p>';
                    html += '<h3>Residents:</h3><ul>';
                    data.residents.forEach(function(character) {
                        html += '<li>' + character.name + ' (' + character.species + ')</li>';
                    });
                    html += '</ul>';
                    document.getElementById('charactersList').innerHTML = html;
                })
                .catch(error => {
                    document.getElementById('charactersList').innerHTML = '<p>Error fetching character data.</p>';
                });
        } else {
            document.getElementById('charactersList').innerHTML = '';
        }
    });
</script>
{% endblock %}
